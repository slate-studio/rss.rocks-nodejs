(function(){var e,t,r,n,o;e=require("feedparser"),o=require("request"),t=require("iconv").Iconv,n=function(e){var t;return t=e.split(";").reduce(function(e,t){var r;return r=t.split("=").map(function(e){return e.trim()}),2===r.length&&(e[r[0]]=r[1]),e},{})},module.exports=r=function(){function r(e){this.urls=e,this.urls.map(function(e){return function(t){return e.fetch(t)}}(this))}return r.prototype.fetch=function(r){var i,s;return s=o(r,{timeout:1e4,pool:!1}),s.setMaxListeners(50),s.setHeader("user-agent","Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36").setHeader("accept","text/html,application/xhtml+xml"),i=new e,s.on("error",this.done),s.on("response",function(e){var r,o,s,u;if(u=this,200!==e.statusCode)return this.emit("error",new Error("Bad status code"));if(r=n(e.headers["content-type"]||"").charset,!s&&r&&!/utf-*8/i.test(r))try{s=new t(r,"utf-8"),console.log("Converting from charset %s to utf-8",r),s.on("error",this.done),u=this.pipe(s)}catch(c){o=c,this.emit("error",o)}return u.pipe(i)}),i.on("error",this.done),i.on("end",this.done),i.on("readable",function(){var e,t;for(t=[];e=this.read();)console.log(e.title),t.push(console.log(e.link));return t})},r.prototype.done=function(e){return e?(console.log(e,e.stack),process.exit(1)):void 0},r}()}).call(this);